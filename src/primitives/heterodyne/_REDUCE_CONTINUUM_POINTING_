# -*-perl-*-

=head1 NAME

_REDUCE_CONTINUUM_POINTING_ - Reduce a heterodyne continuum pointing
observation.

=head1 DESCRIPTION

=head1 ARGUMENTS

=over 4

=back

=head1 NOTES

=over 4

=back

=head1 OUTPUT DATA

=over 4

=back

=head1 TASKS

=head1 REQUIRED PERL MODULES

=head1 AUTHORS

Brad Cavanagh E<lt>b.cavanagh@jach.hawaii.eduE<gt>

=head1 COPYRIGHT

Copyright (C) 2007 Particle Physics and Astronomy Research
Council.  All Rights Reserved.

=cut

# Report to user.
orac_print( "Calculating pointing based on continuum.\n", "green" );

if( $Frm->uhdr( "SPARSE_CUBE" ) ) {

  orac_warn( "Cannot calculate pointing on a sparse cube.\n" );

} else {

  # Store the original Frame object.
  my $origFrm = $Frm->new( $Frm->file );

  {

    my $tmpFrm = $Frm->new;
    $tmpFrm->file( $Frm->file );
    $tmpFrm->readhdr;

    # Find the regions without a line.
    _REMOVE_BASELINE_
    $tmpFrm->uhdr( "BASELINE_REGIONS", $Frm->uhdr( "BASELINE_REGIONS" ) );
    $Frm = $tmpFrm;

    # Create a variance.
    _CREATE_CUBE_VARIANCE_

    # Mask off the ends.
    _MASK_FREQUENCY_ENDS_

    # Collapse the regions without a line.
    _COLLAPSE_BASELINED_REGIONS_

    # Calculate pointing based on the collapsed image.
    _CALCULATE_POINTING_ TYPE=CONTINUUM

  }

  # Reset the Frame object.
  $Frm = $origFrm;

}
