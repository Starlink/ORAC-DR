\documentclass[twoside,11pt]{article}

% +
%  Name:
%     sun236.tex

%  Purpose:
%     SUN documentation for ORAC-DR spectroscopy (SUN/236)

%  Authors:
%     Paul Hirst (JAC)
%     Tim Jenness (JAC)
%     Brad Cavanagh (JAC)

%  Copyright:
%     Copyright (C) 2003 Particle Physics and Astronomy
%     Research Council. All Rights Reserved.

%  History:
%     $Log$
%     Revision 1.18  2004/05/27 21:40:20  bradc
%     updates for v4.1
%
%     Revision 1.17  2003/06/12 22:21:28  bradc
%     June, not May
%
%     Revision 1.16  2003/04/25 01:29:20  bradc
%     updates for 4.0 release
%
%     Revision 1.15  2002/09/16 04:30:21  timj
%     Add stardocversion
%
%     Revision 1.14  2002/09/16 03:21:54  timj
%     Fix minor tweaks
%
%     Revision 1.13  2002/09/16 03:13:33  timj
%     Fix spelling mistake
%
%     Revision 1.12  2002/09/16 03:09:48  timj
%     Brad was correct :-) \ORACDR\ is meant to be a latex command.
%
%     Revision 1.11  2002/09/14 01:49:19  phirst
%     fix Brads LaTeX
%
%     Revision 1.10  2002/05/28 21:12:22  bradc
%     Clarified use of calibration options
%
%     Revision 1.9  2001/12/14 02:58:17  timj
%     Wrong copyright
%
%     Revision 1.8  2001/12/14 02:53:06  timj
%     Minor updates for V3.0-3
%
%     Revision 1.7  2001/12/14 02:20:54  timj
%     even more missing typos
%
%     Revision 1.6  2001/12/14 02:18:17  timj
%     stardoccopyright as 2001
%
%     Revision 1.5  2001/12/14 02:16:53  timj
%     couple of typos plus increment doc number
%
%     Revision 1.4  2001/12/13 01:32:21  phirst
%     Added FAINT_POINT_SOURCE
%
%     Revision 1.3  2001/11/28 03:18:28  timj
%     Add xref to other oracdr docs
%
%     Revision 1.2  2001/11/28 01:58:23  timj
%     - Fix spelling mistakes
%     - Add logo
%     - Remove DESCRIPTION paragraph headings
%     - Tweak some sections to be real lists
%     - Some verbatim tables were not formatted verbatim
%

%  Revision:
%     $Id$

% -


% ? Specify used packages
\usepackage{graphicx}        %  Use this one for final production.
% \usepackage[draft]{graphicx} %  Use this one for drafting.
% ? End of specify used packages

\pagestyle{myheadings}

% -----------------------------------------------------------------------------
% ? Document identification
% Fixed part
\newcommand{\stardoccategory}  {Starlink User Note}
\newcommand{\stardocinitials}  {SUN}
\newcommand{\stardocsource}    {sun\stardocnumber}
\newcommand{\stardoccopyright} {Copyright \copyright\ 2004 Particle Physics and Astronomy Research Council}


% Variable part - replace [xxx] as appropriate.
\newcommand{\stardocnumber}    {236.4}
\newcommand{\stardocauthors}   {Paul Hirst \\ Brad Cavanagh \\
                                Joint Astronomy Centre, Hilo, Hawaii}
\newcommand{\stardocdate}      {June 2004}
\newcommand{\stardoctitle}     {ORAC-DR -- spectroscopy data reduction}
\newcommand{\stardocversion}   {4.1}
\newcommand{\stardocmanual}    {User Guide}
\newcommand{\stardocabstract}  {ORAC-DR is a
general-purpose automatic data-reduction pipeline environment.  This
document describes its use to reduce spectroscopy data collected at the
United Kingdom Infrared Telescope (UKIRT) with the CGS4, UIST and MICHELLE
instruments. }
% ? End of document identification
% -----------------------------------------------------------------------------

% +
%  Name:
%     sun.tex
%
%  Purpose:
%     Template for Starlink User Note (SUN) documents.
%     Refer to SUN/199
%
%  Authors:
%     AJC: A.J.Chipperfield (Starlink, RAL)
%     BLY: M.J.Bly (Starlink, RAL)
%     PWD: Peter W. Draper (Starlink, Durham University)
%
%  History:
%     17-JAN-1996 (AJC):
%        Original with hypertext macros, based on MDL plain originals.
%     16-JUN-1997 (BLY):
%        Adapted for LaTeX2e.
%        Added picture commands.
%     13-AUG-1998 (PWD):
%        Converted for use with LaTeX2HTML version 98.2 and
%        Star2HTML version 1.3.
%      1-FEB-2000 (AJC):
%        Add Copyright statement in LaTeX
%     {Add further history here}
%
% -

\newcommand{\stardocname}{\stardocinitials /\stardocnumber}
\markboth{\stardocname}{\stardocname}
\setlength{\textwidth}{160mm}
\setlength{\textheight}{230mm}
\setlength{\topmargin}{-2mm}
\setlength{\oddsidemargin}{0mm}
\setlength{\evensidemargin}{0mm}
\setlength{\parindent}{0mm}
\setlength{\parskip}{\medskipamount}
\setlength{\unitlength}{1mm}

% -----------------------------------------------------------------------------
%  Hypertext definitions.
%  ======================
%  These are used by the LaTeX2HTML translator in conjunction with star2html.

%  Comment.sty: version 2.0, 19 June 1992
%  Selectively in/exclude pieces of text.
%
%  Author
%    Victor Eijkhout                                      <eijkhout@cs.utk.edu>
%    Department of Computer Science
%    University Tennessee at Knoxville
%    104 Ayres Hall
%    Knoxville, TN 37996
%    USA

%  Do not remove the %begin{latexonly} and %end{latexonly} lines (used by
%  LaTeX2HTML to signify text it shouldn't process).
%begin{latexonly}
\makeatletter
\def\makeinnocent#1{\catcode`#1=12 }
\def\csarg#1#2{\expandafter#1\csname#2\endcsname}

\def\ThrowAwayComment#1{\begingroup
    \def\CurrentComment{#1}%
    \let\do\makeinnocent \dospecials
    \makeinnocent\^^L% and whatever other special cases
    \endlinechar`\^^M \catcode`\^^M=12 \xComment}
{\catcode`\^^M=12 \endlinechar=-1 %
 \gdef\xComment#1^^M{\def\test{#1}
      \csarg\ifx{PlainEnd\CurrentComment Test}\test
          \let\html@next\endgroup
      \else \csarg\ifx{LaLaEnd\CurrentComment Test}\test
            \edef\html@next{\endgroup\noexpand\end{\CurrentComment}}
      \else \let\html@next\xComment
      \fi \fi \html@next}
}
\makeatother

\def\includecomment
 #1{\expandafter\def\csname#1\endcsname{}%
    \expandafter\def\csname end#1\endcsname{}}
\def\excludecomment
 #1{\expandafter\def\csname#1\endcsname{\ThrowAwayComment{#1}}%
    {\escapechar=-1\relax
     \csarg\xdef{PlainEnd#1Test}{\string\\end#1}%
     \csarg\xdef{LaLaEnd#1Test}{\string\\end\string\{#1\string\}}%
    }}

%  Define environments that ignore their contents.
\excludecomment{comment}
\excludecomment{rawhtml}
\excludecomment{htmlonly}

%  Hypertext commands etc. This is a condensed version of the html.sty
%  file supplied with LaTeX2HTML by: Nikos Drakos <nikos@cbl.leeds.ac.uk> &
%  Jelle van Zeijl <jvzeijl@isou17.estec.esa.nl>. The LaTeX2HTML documentation
%  should be consulted about all commands (and the environments defined above)
%  except \xref and \xlabel which are Starlink specific.

\newcommand{\htmladdnormallinkfoot}[2]{#1\footnote{#2}}
\newcommand{\htmladdnormallink}[2]{#1}
\newcommand{\htmladdimg}[1]{}
\newcommand{\hyperref}[4]{#2\ref{#4}#3}
\newcommand{\htmlref}[2]{#1}
\newcommand{\htmlimage}[1]{}
\newcommand{\htmladdtonavigation}[1]{}

\newenvironment{latexonly}{}{}
\newcommand{\latex}[1]{#1}
\newcommand{\html}[1]{}
\newcommand{\latexhtml}[2]{#1}
\newcommand{\HTMLcode}[2][]{}

%  Starlink cross-references and labels.
\newcommand{\xref}[3]{#1}
\newcommand{\xlabel}[1]{}

%  LaTeX2HTML symbol.
\newcommand{\latextohtml}{\LaTeX2\texttt{HTML}}

%  Define command to re-centre underscore for Latex and leave as normal
%  for HTML (severe problems with \_ in tabbing environments and \_\_
%  generally otherwise).
\renewcommand{\_}{\texttt{\symbol{95}}}

% -----------------------------------------------------------------------------
%  Debugging.
%  =========
%  Remove % on the following to debug links in the HTML version using Latex.

% \newcommand{\hotlink}[2]{\fbox{\begin{tabular}[t]{@{}c@{}}#1\\\hline{\footnotesize #2}\end{tabular}}}
% \renewcommand{\htmladdnormallinkfoot}[2]{\hotlink{#1}{#2}}
% \renewcommand{\htmladdnormallink}[2]{\hotlink{#1}{#2}}
% \renewcommand{\hyperref}[4]{\hotlink{#1}{\S\ref{#4}}}
% \renewcommand{\htmlref}[2]{\hotlink{#1}{\S\ref{#2}}}
% \renewcommand{\xref}[3]{\hotlink{#1}{#2 -- #3}}
%end{latexonly}
% -----------------------------------------------------------------------------
% ? Document specific \newcommand or \newenvironment commands.

\newcommand{\ARD}{{\footnotesize ARD}}
\newcommand{\CCDPACK}{{\footnotesize CCDPACK}}
\newcommand{\CONVERT}{{\footnotesize CONVERT}}
\newcommand{\CURSA}{{\footnotesize CURSA}}
\newcommand{\GAIA}{{\footnotesize GAIA}}
\newcommand{\EXTRACTOR}{\mbox{\footnotesize EXTRACTOR}}
\newcommand{\FIGARO}{\mbox{\footnotesize FIGARO}}
\newcommand{\KAPPA}{{\footnotesize KAPPA}}
\newcommand{\ORACDR}{{\footnotesize ORAC-DR}}
\newcommand{\PHOTOM}{{\footnotesize PHOTOM}}
\newcommand{\PISA}{{\footnotesize PISA}}
\newcommand{\POLPACK}{{\footnotesize POLPACK}}


% ? End of document specific commands
% -----------------------------------------------------------------------------
%  Title Page.
%  ===========
\renewcommand{\thepage}{\roman{page}}
\begin{document}
\setcounter{secnumdepth}{5}
\thispagestyle{empty}

%  Latex document header.
%  ======================
\begin{latexonly}
   CCLRC / \textsc{Rutherford Appleton Laboratory} \hfill \textbf{\stardocname}\\
   {\large Particle Physics \& Astronomy Research Council}\\
   {\large Starlink Project\\}
   {\large \stardoccategory\ \stardocnumber}
   \begin{flushright}
   \stardocauthors\\
   \stardocdate
   \end{flushright}
   \vspace{-4mm}
   \rule{\textwidth}{0.5mm}
   \vspace{5mm}
   \begin{center}
   {\Huge\textbf{\stardoctitle \\ [2.5ex]}}
   {\LARGE\textbf{\stardocversion \\ [4ex]}}
   {\Huge\textbf{\stardocmanual}}
   \end{center}
   \vspace{5mm}

% ? Add picture here if required for the LaTeX version.
%   e.g. \includegraphics[scale=0.3]{filename.ps}
\begin{center}
\includegraphics[width=1.0in]{sun236_logo.eps}
\end{center}
% ? End of picture

% ? Heading for abstract if used.
   \vspace{10mm}
   \begin{center}
      {\Large\textbf{Abstract}}
   \end{center}
% ? End of heading for abstract.
\end{latexonly}

%  HTML documentation header.
%  ==========================
\begin{htmlonly}
   \xlabel{}
   \begin{rawhtml} <H1> \end{rawhtml}
      \stardoctitle\\
      \stardocversion\\
      \stardocmanual
   \begin{rawhtml} </H1> <HR> \end{rawhtml}

% ? Add picture here if required for the hypertext version.
%   e.g. \includegraphics[scale=0.7]{filename.ps}
\includegraphics[width=1.0in]{sun236_logo.eps}
% ? End of picture

   \begin{rawhtml} <P> <I> \end{rawhtml}
   \stardoccategory\ \stardocnumber \\
   \stardocauthors \\
   \stardocdate
   \begin{rawhtml} </I> </P> <H3> \end{rawhtml}
      \htmladdnormallink{CCLRC / Rutherford Appleton Laboratory}
                        {http://www.cclrc.ac.uk} \\
      \htmladdnormallink{Particle Physics \& Astronomy Research Council}
                        {http://www.pparc.ac.uk} \\
   \begin{rawhtml} </H3> <H2> \end{rawhtml}
      \htmladdnormallink{Starlink Project}{http://www.starlink.rl.ac.uk/}
   \begin{rawhtml} </H2> \end{rawhtml}
   \htmladdnormallink{\htmladdimg{source.gif} Retrieve hardcopy}
      {http://www.starlink.rl.ac.uk/cgi-bin/hcserver?\stardocsource}\\

%  HTML document table of contents.
%  ================================
%  Add table of contents header and a navigation button to return to this
%  point in the document (this should always go before the abstract \section).
  \label{stardoccontents}
  \begin{rawhtml}
    <HR>
    <H2>Contents</H2>
  \end{rawhtml}
  \htmladdtonavigation{\htmlref{\htmladdimg{contents_motif.gif}}
        {stardoccontents}}

% ? New section for abstract if used.
  \section{\xlabel{abstract}Abstract}
% ? End of new section for abstract
\end{htmlonly}

% -----------------------------------------------------------------------------
% ? Document Abstract. (if used)
%  ==================
\stardocabstract
% ? End of document abstract

% -----------------------------------------------------------------------------
% ? Latex Copyright Statement
%  =========================
\begin{latexonly}
\newpage
\vspace*{\fill}
\stardoccopyright
\end{latexonly}
% ? End of Latex copyright statement

% -----------------------------------------------------------------------------
% ? Latex document Table of Contents (if used).
%  ===========================================
  \newpage
  \begin{latexonly}
    \setlength{\parskip}{0mm}
    \tableofcontents
    \setlength{\parskip}{\medskipamount}
    \markboth{\stardocname}{\stardocname}
  \end{latexonly}
% ? End of Latex document table of contents
% -----------------------------------------------------------------------------

\cleardoublepage
\renewcommand{\thepage}{\arabic{page}}
\setcounter{page}{1}

% ? Main text

\section{Introduction}

This document describes the spectroscopy recipes and primitives included with
\ORACDR. See \xref{SUN/230}{sun230}{} for general \ORACDR\ documentation,
\xref{SUN/232}{sun232}{} for information on \ORACDR\ imaging data reduction,
and \xref{SUN/246}{sun246}{} for information on \ORACDR\ integral field
spectroscopy data reduction.

At this time (June 2004), \ORACDR's spectroscopy suite is designed
to reduce data from the UKIRT spectrometer suite: CGS4, UIST and
MICHELLE; data from the AAT imaging spectrometer IRIS2, and data
from the ESO imaging spectrometer ISAAC. The recipes and primitives
are written in such a way as to make the addition of new instruments
simple.

\section{Recipe and Primitive Architecture}

In general, an \ORACDR\ recipe is simply a list of primitives, which
are executed in turn on the data from each observation that is passed
through the pipeline. The primitives form building blocks, each
carrying out an atomic data reduction operation. Thus, the recipe is
readable, understandable and to some extent modifiable by someone not
familiar with the primitive internals -- for example an observer or
scientist reducing data and wishing to add or remove steps from the
data reduction process. The primitives themselves are implemented in
Perl5 and are not designed to be usefully modifiable by a
non-programmer.

In actual fact, it has been found to be beneficial in many places to
take this abstraction one level deeper -- in the spectroscopy pipeline
many of the steps which we wish to denote in the recipe as a single
primitive are themselves too complex to be considered an atomic data
reduction operation, perhaps a good analogy is that be considered a
molecular operation, themselves implemented as a simple list of
primitives which carry out the true atomic operations. In some cases
there is simple logic, generally simple flow control switches, for
example ``if'' clauses at the molecular level, though this code is
simple and these molecular level primitives can be usefully modified
to add or remove steps by a typical astronomer.

\section{The Recipes}

Each recipe has an in-code documentation section, which documents the
recipe concerned. Here, we simply divide the recipes into groups
corresponding to the type of observations they reduce, and give the
recipe documentation.

Some of the recipes have dedicated primitives, this is simply to
avoid having the perl code in the recipe. In these cases, we include
the primitive documentation with that of the recipe. For the main
science recipes, we will describe the recipes at molecular level
here, with the details of the primitives in a subsequent section.

\subsection{System Verification Recipes and Primitives}

\subsubsection{ARRAY\_TESTS}

Strictly speaking, the ARRAY\_TESTS recipe is not part of the \ORACDR\
spectroscopy suite; each instrument provides its own array tests
recipe if it requires one. However, if one is provided, it can
generate bad pixel masks and read-noise measurements that will be used
by the rest of the spectroscopy pipeline. In fact, a read-noise number
is mandatory for the spectroscopy pipeline, and thus if not determined
by an array tests procedure, has to be supplied manually, usually by
the instrument scientist. The CGS4 specific array tests recipe is
described here, as it is currently a good example.

%% ORACDRDOC_RECIPE:ARRAY_TESTS

%% ORACDRDOC_PRIMITIVE:_ARRAY_TESTS_

%% ORACDRDOC_PRIMITIVE:_ARRAY_TESTS_STATISTICS_

%% ORACDRDOC_PRIMITIVE:_FIND_BAD_PIXELS_

\subsubsection{EMISSIVITY}

It is not strictly necessary for each instrument to be able to take
emissivity data, though currently both CGS4 and MICHELLE do, and it is
strongly anticipated that UIST also will in the near future.

%% ORACDRDOC_RECIPE:EMISSIVITY

%% ORACDRDOC_PRIMITIVE:_EMISSIVITY_

\subsection{Calibration Frame Recipes}

\subsubsection{Flat Fields}

The REDUCE\_FLAT recipe will reduce a FLAT field observation. FLAT
observations are usually taken by observing the black-body source in
the CGS4 calibration unit, though the Tungsten-Halogen lamp is used at
the shorter CGS4 wavelengths. Standard operating procedures for
MICHELLE flats have yet to be ascertained, though REDUCE\_FLAT will
work fine if the (warm) shutter of the instrument is used as a black
body source. Sky flats will probably be reduced by an (as yet
unwritten) separate recipe.

%% ORACDRDOC_RECIPE:REDUCE_FLAT

Dark-subtraction can also be performed for flat fields.

%% ORACDRDOC_RECIPE:REDUCE_FLAT_WITH_DARK

%% ORACDRDOC_PRIMITIVE:_NORMALISE_FLAT_BY_BB_

\subsubsection{Arc Lamp observations}

The REDUCE\_ARC recipe reduces a CGS4 ARC lamp observation. Currently
the arc frame is not actually used for wavelength calibration, though
this will probably change shortly.

%% ORACDRDOC_RECIPE:REDUCE_ARC

\subsubsection{Dark Frames}

The REDUCE\_DARK recipe will reduce and file a DARK observation. In
practice this is very rarely used as the dark current of the array is
intrinsically subtracted when subtracting a sky or offset beam frame.

%% ORACDRDOC_RECIPE:REDUCE_DARK

\subsubsection{Bias Frames}

The REDUCE\_BIAS recipe reduces a bias observation. The default BIAS
observation takes 3 integrations, each containing many exposures. The
REDUCE\_BIAS recipe forms a variance array based on the variance of the
3 integrations in the observation.


%% ORACDRDOC_RECIPE:REDUCE_BIAS

%% ORACDRDOC_PRIMITIVE:_REDUCE_BIAS_


\subsection{Calibration Star Recipes}

\subsubsection{STANDARD\_STAR}
%% ORACDRDOC_RECIPE:STANDARD_STAR
%% ORACDRDOC_RECIPE:STANDARD_STAR_NOFLAT
%% ORACDRDOC_PRIMITIVE:_STANDARD_STAR_

\subsection{Science target Recipes}

\subsubsection{POINT\_SOURCE}

The POINT\_SOURCE recipe reduces observations of point sources, with
nodding along the slit or off to sky (the reason you'd go off to sky
with a point source being that it's in a crowded field).


Variants: \\
\_NOFLAT - does not do flat fielding \\
\_NOSTD - does not ratio by standard star \\
\_NOFLAT\_NOSTD - does not flat field or ratio by standard star \\

%% ORACDRDOC_RECIPE:POINT_SOURCE
%% ORACDRDOC_RECIPE:POINT_SOURCE_NOFLAT
%% ORACDRDOC_RECIPE:POINT_SOURCE_NOSTD
%% ORACDRDOC_RECIPE:POINT_SOURCE_NOFLAT_NOSTD

\subsubsection{FAINT\_POINT\_SOURCE}

The FAINT\_POINT\_SOURCE recipe is similar to POINT\_SOURCE, except in
determining where to centre the opt-extract windows. With
POINT\_SOURCE, the windows are centred on peaks and troughs detected
in the y-profile of the sky subtracted group image. This is also the
case for STANDARD\_STAR. However, STANDARD\_STAR writes the locations
of the beams to the rows calibration system. FAINT\_POINT\_SOURCE gets
these values from the calibration system rather than the y-profile of
the image.

Thus, FAINT\_POINT\_SOURCE is useful both for crowded fields or
faint targets, where it's not obvious from the group image where to
extract. For this to be useful, the object of interest must be centred
on the same rows as the standard star was. This will be the case unless
you deliberately change the telescope-instrument aperture, peak-up row
or offset distance between observing the standard and the target.

Variants: \\
\_NOFLAT - does not do flat fielding \\
\_NOSTD - does not ratio by standard star \\
\_NOFLAT\_NOSTD - does not flat field or ratio by standard star \\

%% ORACDRDOC_RECIPE:FAINT_POINT_SOURCE
%% ORACDRDOC_RECIPE:FAINT_POINT_SOURCE_NOFLAT
%% ORACDRDOC_RECIPE:FAINT_POINT_SOURCE_NOSTD
%% ORACDRDOC_RECIPE:FAINT_POINT_SOURCE_NOFLAT_NOSTD

\subsubsection{EXTENDED\_SOURCE}

The EXTENDED\_SOURCE recipe reduces observations of extended sources.

Variants: \\
\_NOFLAT - does not do flat fielding \\
\_NOSTD - does not ratio by standard star \\
\_NOFLAT\_NOSTD - does not flat field or ratio by standard star \\

%% ORACDRDOC_RECIPE:EXTENDED_SOURCE
%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_NOFLAT
%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_NOSTD
%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_NOFLAT_NOSTD

\subsubsection{Extended source with a stable sky background}

The EXTENDED\_SOURCE\_SEPARATE\_SKY recipe is for use when the sky is
sufficiently stable, that you do not need to spend half your time
observing it. This is only expected to be of use with CGS4 echelle
observations. For point sources, you would nod along the slit anyway.

Variants: \\
\_NOFLAT - does not do flat fielding \\
\_NOSTD - does not ratio by standard star \\
\_NOFLAT\_NOSTD - does not flat field or ratio by standard star \\

%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_WITH_SEPARATE_SKY
%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_WITH_SEPARATE_SKY_NOFLAT
%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_WITH_SEPARATE_SKY_NOSTD
%% ORACDRDOC_RECIPE:EXTENDED_SOURCE_WITH_SEPARATE_SKY_NOFLAT_NOSTD

\subsubsection{Blank Sky Observations}

%% ORACDRDOC_RECIPE:REDUCE_SKY
%% ORACDRDOC_RECIPE:REDUCE_SKY_WITH_DARK

\subsection{Utility Recipes}

\subsubsection{Night Logs}

The NIGHT\_LOG recipe is the default recipe for generating summary
logs of a list of observations. The NIGHT\_LOG\_LONG variant adds more
details to the log file.

%% ORACDRDOC_RECIPE:NIGHT_LOG
%% ORACDRDOC_RECIPE:NIGHT_LOG_LONG
%% ORACDRDOC_PRIMITIVE:_NIGHT_LOG_

\subsection{Molecular Primitives}

\subsubsection{To Reduce a Single Observation to a \_wce frame}

%% ORACDRDOC_PRIMITIVE:_REDUCE_SINGLE_FRAME_

\subsubsection{Pairwise Grouping}

%% ORACDRDOC_PRIMITIVE:_PAIRWISE_GROUP_

\subsubsection{Extracting and Coadding Spectra}

%% ORACDRDOC_PRIMITIVE:_EXTRACT_SPECTRA_
%% ORACDRDOC_PRIMITIVE:_EXTRACT_DETERMINE_NBEAMS_
%% ORACDRDOC_PRIMITIVE:_EXTRACT_FIND_ROWS_
%% ORACDRDOC_PRIMITIVE:_EXTRACT_ALL_BEAMS_
%% ORACDRDOC_PRIMITIVE:_DERIPPLE_ALL_BEAMS_
%% ORACDRDOC_PRIMITIVE:_CROSS_CORR_ALL_BEAMS_
%% ORACDRDOC_PRIMITIVE:_COADD_EXTRACTED_BEAMS_

\subsubsection{Using Standard Stars}

%% ORACDRDOC_PRIMITIVE:_DIVIDE_BY_STANDARD_
%% ORACDRDOC_PRIMITIVE:_ALIGN_SPECTRUM_TO_STD_
%% ORACDRDOC_PRIMITIVE:_FLUX_CALIBRATE_

\subsection{Historical Recipe Names}

Historical data taken with the main historical recipes, SOURCE\-\_PAIRS\-\_ON\-\_SLIT
and SOURCE\-\_PAIRS\-\_TO\-\_SKY should now be reduced with POINT\-\_SOURCE or
EXTENDED\_SOURCE as appropriate. Use POINT\_SOURCE if in doubt.

Historical data taken with SOURCE\_WITH\_NOD\_TO\_BLANK\_SKY should now
be reduced with EXTENDED\_SOURCE\_WITH\_SEPARATE\_SKY.

\section{Calibration Information}

\ORACDR\ records calibration information, such as dark frames, flat
fields, and the read noise, within index files, one for each type of
calibration information.  When the pipeline needs a calibration frame
it searches the index file for the best matching entry subject to a
set of rules. Each recipe reports the calibrations it has used.  If no
suitable calibration exists, the pipeline exits with an error message
stating this fact.  For further details see
\xref{SUN/230}{sun230}{calibration_selection}.

You can also select a specific calibration using the {\tt -calib}
command-line option, provided the chosen calibration has an entry
in the appropriate index file.  See
\begin{latexonly}
the section on
\end{latexonly}
\xref{calibration options}{sun230}{calibration_options}
\begin{latexonly}
in SUN/230
\end{latexonly}
for details and examples.

\subsection{Available Calibration Methods}

The following calibration methods are available for CGS4:

\begin{itemize}

\item baseshift - Use the given comma separated doublet (i.e. ``0,0'') as the
frame's base position.

\item bias - Use the given bias frame.

\item dark - Use the given dark frame.

\item flat - Use the given flat frame.

\item mask - Use the given mask. Usually used for bad pixel masks.

\item profile - Use the given frame as an extraction profile.

\item readnoise - Use the given value for the detector readnoise.

\item rotation - Use the given frame as a rotation matrix.

\item rowname - Use the given frame to calculate the positions of the positive
and negative rows.

\item sky - Use the given sky frame.

\item standard - Use the given standard star frame.

\end{itemize}

% ? End of main text
\end{document}
